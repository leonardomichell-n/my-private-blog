<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Thoughts</title>
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 700px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        
        header {
            margin-bottom: 3rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #eee;
            position: relative;
        }
        
        .logout-btn {
            position: absolute;
            top: 0;
            right: 0;
            background: #f0f0f0;
            color: #333;
            padding: 0.5rem 1rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
        }
        
        .logout-btn:hover {
            background: #e0e0e0;
        }
        
        h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        
        .subtitle {
            color: #666;
            font-size: 0.9rem;
        }
        
        .music-player {
            margin-top: 1rem;
        }
        
        .music-btn {
            background: #f0f0f0;
            color: #333;
            padding: 0.5rem 1rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        
        .music-btn:hover {
            background: #e0e0e0;
        }
        
        .music-btn.playing {
            background: #333;
            color: white;
            border-color: #333;
        }
        
        article {
            margin-bottom: 3rem;
        }
        
        article h2 {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }
        
        .date {
            color: #999;
            font-size: 0.85rem;
            margin-bottom: 1rem;
        }
        
        .content {
            margin-bottom: 1rem;
        }
        
        .email-form {
            background: #f9f9f9;
            padding: 2rem;
            border-radius: 8px;
            margin-top: 3rem;
        }
        
        .email-form h3 {
            margin-bottom: 1rem;
        }
        
        .form-group {
            margin-bottom: 1rem;
        }
        
        label {
            display: block;
            margin-bottom: 0.3rem;
            font-weight: 500;
        }
        
        input, textarea {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: inherit;
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        button {
            background: #333;
            color: white;
            padding: 0.7rem 1.5rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
        }
        
        button:hover {
            background: #555;
        }
        
        button:disabled {
            background: #999;
            cursor: not-allowed;
        }
        
        .message {
            padding: 1rem;
            margin-top: 1rem;
            border-radius: 4px;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
        }
        
        .privacy-note {
            font-size: 0.85rem;
            color: #666;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid #eee;
        }
    </style>
</head>
<body>
    <header>
        <button class="logout-btn" onclick="netlifyIdentity.logout()">Logout</button>
        <h1>My Thoughts</h1>
        <p class="subtitle">A private space for personal reflections</p>
        
        <div class="music-player">
            <audio id="bgMusic" loop>
                <source src="/music/background.mp3" type="audio/mpeg">
                <source src="/music/background.ogg" type="audio/ogg">
                Your browser does not support the audio element.
            </audio>
            <button id="musicToggle" class="music-btn">ðŸŽµ Play Music</button>
        </div>
    </header>

    <main>
        <article>
            <h2>Welcome</h2>
            <p class="date">January 2026</p>
            <div class="content">
                <p>This is your private blog. Edit this HTML file to add your thoughts and ideas. Each article can be a new &lt;article&gt; section.</p>
                <p>No analytics. No tracking. Just your words.</p>
            </div>
        </article>

        <article>
            <h2>Getting Started</h2>
            <p class="date">January 2026</p>
            <div class="content">
                <p>To add new posts, simply duplicate the article sections in the HTML and update the content. The site uses system fonts and no external resources for maximum privacy.</p>
            </div>
        </article>

        <div class="email-form">
            <h3>Send Me a Message</h3>
            <form id="contactForm">
                <div class="form-group">
                    <label for="name">Your Name</label>
                    <input type="text" id="name" name="name" required>
                </div>
                <div class="form-group">
                    <label for="email">Your Email</label>
                    <input type="email" id="email" name="email" required>
                </div>
                <div class="form-group">
                    <label for="message">Message</label>
                    <textarea id="message" name="message" required></textarea>
                </div>
                <button type="submit" id="submitBtn">Send Message</button>
                <div id="formMessage"></div>
            </form>
        </div>
    </main>

    <footer class="privacy-note">
        <p><strong>Privacy Notice:</strong> This site uses Netlify Identity for authentication. No analytics or tracking. Messages are sent directly via serverless function.</p>
    </footer>

    <script>
        // Netlify Identity initialization
        if (window.netlifyIdentity) {
            window.netlifyIdentity.on("init", user => {
                if (!user) {
                    window.netlifyIdentity.on("login", () => {
                        document.location.href = "/";
                    });
                }
            });
        }

        // Music player functionality
        const audio = document.getElementById('bgMusic');
        const musicToggle = document.getElementById('musicToggle');
        let isPlaying = false;
        
        musicToggle.addEventListener('click', () => {
            if (isPlaying) {
                audio.pause();
                musicToggle.textContent = 'ðŸŽµ Play Music';
                musicToggle.classList.remove('playing');
            } else {
                audio.play();
                musicToggle.textContent = 'â¸ï¸ Pause Music';
                musicToggle.classList.add('playing');
            }
            isPlaying = !isPlaying;
        });
        
        // Contact form functionality
        document.getElementById('contactForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const btn = document.getElementById('submitBtn');
            const messageDiv = document.getElementById('formMessage');
            
            btn.disabled = true;
            btn.textContent = 'Sending...';
            messageDiv.innerHTML = '';
            
            const formData = {
                name: document.getElementById('name').value,
                email: document.getElementById('email').value,
                message: document.getElementById('message').value
            };
            
            try {
                const response = await fetch('/.netlify/functions/send-email', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    messageDiv.innerHTML = '<div class="message success">Message sent successfully!</div>';
                    document.getElementById('contactForm').reset();
                } else {
                    throw new Error(data.error || 'Failed to send message');
                }
            } catch (error) {
                messageDiv.innerHTML = `<div class="message error">Error: ${error.message}</div>`;
            } finally {
                btn.disabled = false;
                btn.textContent = 'Send Message';
            }
        });
    </script>
</body>
</html>